<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    

<script>
    ! function () {
        var e = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches,
            t = localStorage.getItem("use-color-scheme") || "auto";
        ("dark" === t || e && "light" !== t) && document.documentElement.classList.toggle("dark", !0)
    }()
</script>

<meta charset="utf-8">

<title>近期uniapp使用及总结</title>
<meta name="keywords" content="uniapp,uniapp介绍,uniapp总结,uniapp字体,字体导入">
<meta name="description" content="​    吃什么饭对于有选择困难的我来说是个大问题,所以想做个根据自己输入的食物随机分配每餐吃的东西,然后就准备用uniapp做这样一个软件,主要是uniapp打包生成移动端app比较方便.然后就去看了一下uniapp,就像把这两天敲代码遇">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/style/main.css">


<link rel="stylesheet" href="/style/jquery.fancybox.min.css">




<link rel="stylesheet" href="/style/prism.css" />




  <meta name="generator" content="Hexo 5.4.0"></head>
  <body>
    <div id="app" class="main">

<div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://Plumliil.github.io">
        <img class="avatar" src="/images/favicon.png" alt="" width="32px" height="32px">
      </a>
      <a href="https://Plumliil.github.io">
        <h1 class="site-title">Plumliil</h1>
      </a>
    </div>
    <div class="right">
        <i class="icon menu-switch icon-menu-outline" ></i>
    </div>
  </div>
</div>

<div class="menu-container" style="height: 0;opacity: 0;">
<nav class="menu-list">
  
    
      <a href="/" class="menu purple-link">
        首页
      </a>
    
  
    
      <a href="/tags" class="menu purple-link">
        标签
      </a>
    
  
    
      <a href="/categories" class="menu purple-link">
        分类
      </a>
    
  
    
      <a href="/archives" class="menu purple-link">
        归档
      </a>
    
  
    
      <a href="/about" class="menu purple-link">
        关于
      </a>
    
  
</nav>
</div>



  <div class="content-container">
    <div class="post-detail">
      
      <h2 class="post-title">近期uniapp使用及总结</h2>
      <div class="post-info post-detail-info">
        <span><i class="icon icon-calendar-outline"></i> 2022-03-31</span>
        
          <span>
          <i class="icon icon-pricetags-outline"></i>
            
              <a href="/tags/%E5%89%8D%E7%AB%AF%E7%AF%87/">
              前端篇
                
                  ，
                
              </a>
            
              <a href="/tags/uniapp/">
              uniapp
                
                  ，
                
              </a>
            
              <a href="/tags/%E8%B8%A9%E5%9D%91/">
              踩坑
                
              </a>
            
          </span>
        
      </div>
      <div class="post-content-wrapper">
        <div class="post-content">
          <p>​    吃什么饭对于有选择困难的我来说是个大问题,所以想做个根据自己输入的食物随机分配每餐吃的东西,然后就准备用uniapp做这样一个软件,主要是uniapp打包生成移动端app比较方便.然后就去看了一下uniapp,就像把这两天敲代码遇到的问题及心得总结一下.</p>
<p>​    总的来书uniapp的开发和vue的开发差不多,所以用起来也就很快的熟练了起来,但是有些组件以及api的调用还是不同</p>
<p>​    首先从uniapp新建项目开始吧,因为我要做的是uni-app所以就选择了默认的模板.然后来看一下</p>
<h5 id="uniapp基本目录结构"><a href="#uniapp基本目录结构" class="headerlink" title="uniapp基本目录结构"></a>uniapp基本目录结构</h5><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">│  App.vue
│  index.html
│  main.js
│  manifest.json
│  pages.json
│  uni.scss
├─commons
│  ├─css 
│  ├─imgs  
│  └─js
├─components
│  └─eatWhat
├─pages
│  └─index
├─static
└─util<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>​    <strong>App.vue</strong> 是uni-app的主组件，所有页面都是在 App.vue 下进行切换的，是<strong>页面入口文件</strong>,和vue中的.App.vue类似,也有些不同,uniapp的App.vue页面中没有tempate模板,而是只有script和style这两个标签,uniapp页面中公共的样式可以放在Vue.app这个页面的style中.<strong>index.html</strong>是运行之后生成的,所有的东西都会渲染到这上面,manifest.json进行一些基础的配置,<strong>pages.json</strong>中是配置一些页面信息,导航栏信息等<strong>uni.scss</strong>是一些公共样式的配置.在使用scss是可以方便的引用</p>
<p>​    文件夹中commons和components,util这三个文件夹是我自己创建的<strong>commons</strong>是放置一些公共的东西,css,js之类的文件,<strong>components</strong>主要放置一些组件,有vue开发经验的小伙伴应该对这个很熟悉.而<strong>util</strong>放一些封装的一些工具方法,<strong>pages</strong>中放的是所有的页面,<strong>static</strong>中放置静态资源.</p>
<p>​    说完了基本的目录结构就来说一下最近遇到的问题</p>
<h5 id="储存"><a href="#储存" class="headerlink" title="储存"></a>储存</h5><p>​    吃点啥这个块用到最多的就是信息的存储与读取,我一开始想到的就是用storage来进行数据的存储,然后再给当日获取到的食物设置过期时间,超过12小时后清空然后就去查了下官方文档,发现只能简单的设置值,没法直接这设置过期时间,所以只能自己来设置.</p>
<p>下面就把代码贴出来:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">cache</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> time <span class="token operator">=</span> <span class="token number">3600</span> <span class="token operator">*</span> <span class="token number">12</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">let</span> nowTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">// 设置到期时间</span>
		<span class="token keyword">let</span> expire <span class="token operator">=</span> nowTime <span class="token operator">+</span> <span class="token function">Number</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
		uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'|'</span> <span class="token operator">+</span> expire<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">let</span> val <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token comment">// 判断缓存是否过期</span>
			<span class="token keyword">let</span> temp <span class="token operator">=</span> val<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> nowTime<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
				uni<span class="token punctuation">.</span><span class="token function">removeStorageSync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">'缓存已失效'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
				<span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>uni.getStorageSync(key)</code>和<code>uni.setStorageSync(key,value)</code>是uniapp中同步设置和获取缓存的两个api,我们可以通过在设置值是添加一个设置值的时间,然后在获取值时进行判断,当设置时间-获取时间&gt;过期时间时,缓存无效,通过<code>uni.removeStorageSync</code>移除缓存,以此方法来设置过期时间</p>
<h5 id="字体导入与使用"><a href="#字体导入与使用" class="headerlink" title="字体导入与使用"></a>字体导入与使用</h5><p>​    另一个问题是字体的导入,因为第一次在uniapp中设置字体,遇到了点困难,所以这个也需要记录下来.</p>
<p>​    字体导入首先是引入字体,到网上下载了心仪字体的ttf文件.放在了static的font文件夹里</p>
<p>然后又去公共的样式文件中设置了<code>global.css</code>如下:</p>
<pre class="line-numbers language-scss" data-language="scss"><code class="language-scss"><span class="token comment">// global.css</span>
<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">&#123;</span>
	<span class="token property">font-family</span><span class="token punctuation">:</span>YangRenDongZhuShiTi<span class="token punctuation">;</span>
	<span class="token property">src</span><span class="token punctuation">:</span> <span class="token url">url</span><span class="token punctuation">(</span><span class="token string">'~@/static/font/xxxxxx.ttf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>因为我的字体需要全局引用,所以又到App.vue中设置了一下公共页面的css最后完成字体的设置.</p>
<p>其他的都是一些js逻辑之类,相对较简单,以后遇到问题继续补充…</p>

        </div>
        <div class="top-div">
          
        </div>
      </div>
    </div>

    
      <div class="next-post">
        <a class="purple-link" href="/object-object/20220329-ru-he-jin-xing-wang-zhan-xing-neng-you-hua/">
          <h3 class="post-title">
            下一篇：如何进行网站优化
          </h3>
        </a>
      </div>
    
  </div>




<footer>
<div class="site-footer">
  <div class="social-container">
    
      
        <a href="https://github.com/Plumliil" target="_blank">
          <i class="icon icon-github"></i>
        </a>
      
    
      
        <a href="https://twitter.com/PlumLiil" target="_blank">
          <i class="icon icon-twitter"></i>
        </a>
      
    
      
    
      
    
      
    
  </div>
  
  
  
  
  
  
</div>
</footer>


      </div>
      
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.fancybox.min.js"></script>



    <script>window.is_post = true;</script>


<script src="/js/main.js"></script>





    </div>
  </body>
</html>

